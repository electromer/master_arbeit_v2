\chapter{Conclusion and Outlook}
\label{ch:conclusion}


In thesis a controller is proposed to minimize the reflected mass for a 7-DOF LWR that is mounted on a linear axis. For this several null space schemes are reviewed, at torque and velocity level. At torque level, projecting the gradient of the reflected mass into the null space shows poor performance close to maxima because the commanded torques are not able to overcome the friction of the rotational joints. An approach based on an attractive potential  overcomes this problem. For this potential, it is necessary to set a goal position. First global minimization is considered, so the goal position will be the configuration with the lowest reflected mass in the null space.  For a given trajectory, the computation of the minimum may be done offline. Offline computation would also include path planning to the global minimum. This is necessary because the robot may go through local peaks of maximum reflected mass, on its trajectory to the global minimum. However, the global minimum is prone to discontinuities, so a local minimum is preferred for the attractive potential. \\
For the search of the local minimum in the reflected mass, two fundamental optimization techniques are considered, namely Trust Region and Line Search. The Trust Region techniques require an analytical form of the reflected mass constrained to the null space motion. Not being possible to obtain an analytical form, the Line Search techniques are preferred in this work. Therefore, a null space velocity that minimizes the reflected mass is required. The Projected Gradient and the Reduced Gradient approaches are implemented and discussed. Since we are minimizing locally, real-time capabilities are pursued. The Reduced Gradient is therefore chosen for being more computationally efficient. This method also allows decoupling on the minimization. Meaning, that the minimization w.r.t. the redundant joints can be done independently. So one may choose the joints used for the minimization. By exploiting this characteristic a joint limit avoidance strategy is developed.  The Reduced Gradient is obtained analytically and numerically. Inherent to the gradient descent method, oscillations close to the minima appear during the minimization. This happens when the problem is ill-conditioned (high condition number). Decreasing the step size causes slow motion, so other line search techniques are implemented in this thesis in order to decrease oscillations and increase convergence rate. Three Conjugate Gradient Descent methods are tested, showing in general worse convergence than the original Gradient Descent. Two Quasi-Newton methods are tested as well, showing in general not a significant improvement in the convergence rate w.r.t. the Gradient Descent. Therefore, the Gradient Descent is chosen for simplicity. %Still showing oscillations, an algorithm is developed in which several iterations are computed in order to detect and decrease these oscillations. 
Still showing oscillations, a  non-normalized joint velocity is chosen. This bounded velocity,  shows good dynamics in the minimization and ensures no oscillations close to minima.

An algorithm based on the Reduced  Gradient is implemented in a real-time capable controller. The controller is tuned for both, the analytical and the numerical approach. The addition of damping is necessary to decrease the overshooting in the joints, especially in the linear axis. The analytical approach is  computationally more efficient. The numerical approach is more robust to parameters' variation.
Finally the controller is implemented in combination with the SMU. The SMU ensures safe motion, while the controller here developed shows to improve the performance of the robot.



%\section{Future work}
%\label{sec:future_work}
%
%Prove analytically that the integral of kernel of the Jacobian of the LWR (\ref{eq:dq_ns}) has no closed form. An attempt has been done in this work finding the most simple terms of this kernel and searching for a closed form of their integrals. Although software like Mathematica is not able to obtain these closed forms directly, in this thesis it is proved that some of them have closed form. Further analysis of the remaining terms is left to future work, since proving that one of this terms has no closed form would be enough to prove that the integral of the kernel has not closed form either. 
%\subsection{Generalization to n-DOF}
%\label{subsec:extension_ndof}
%
\section{Future work}
-more efficient ways to compute these matrices and their inverses to allow higher nmax. Specially in the numerical approach

